# python3实现的前端资源文件(js/css)版本号修改器软件

github: https://github.com/Copterfly/FeResourceVersionEditor

关于软件的前世今生请移步本人博客了解： http://www.copterfly.cn/server-side/python/feResourceVersionEditor.html

## 目的

软件都是为了解决某种问题的需求而产生的，但开源此软件的目的不是为了给前端er们一个修改资源文件版本号的工具，而是给学习 `python GUI(tkinter)` 开发或者软件开发的朋友们一个参考。毕竟现在不支持前端自动化的老旧结构的网站已经不多了，而且由于项目的特殊性，所以您拿到打包好的最终 `exe` 程序也不太可能用在自己的项目上。

但我还是上传了一份最终生成的 exe 文件，供您体验/研究。

因为是第一次搞 GUI 开发，研发的过程中可谓困难重重，所以源码中保留了大量的调试注释，也是对自己开发思路的一种记录。希望能帮到有需要的朋友。

使用说明请往下阅读。

## 缘起

由于某老旧主项目（以下用 `ABC项目` 表示）是传统的多页面结构，无法应用 `Gulp` 等前端自动化工具(已经有很多旧页面，不要重构，你懂的)，对于前端er来说，修改 `js/css` 文件，提交更新到公网后不生效，原因是有缓存，要手动把相应文件的版本号更新后才生效。

手动的情形是：如果同时修改了几个 `js` 和 `css` 文件，在模板文件中查找引用了 `js/css` 的地方，有时竟多达几十处，然后再手动一处一处的更新，比如把：`abc.js?v=20180101-1055` 改为 `abc.js?v=20180102-1403` 。

这简直要疯掉啊。

一是很烦，二是很浪费时间和生命，三是很容易改错。有位同事有一次就把 script src 后面的一个双引号误删掉了，页面报错半天找不出来原因。

多方求助无果后，想着求人不如求己，自助者天助，于是操起 python 捣鼓几天，弄出来个半自动化的版本号修改器。

**简介**

本软件可批量修改前端资源文件(css/js)的版本号。

本软件诞生初衷为提高前端工作效率，防止手动修改出错，解放生产力。

本软件只适用于64位 windows 操作系统，32位应该打不开。（如果你把代码拿到32位系统下打包，那32位也可以正常使用）

本软件只适用于 `ABC项目`，请勿用在其它项目上。

本软件为绿色软件，无毒无害，解压即可使用（如某数字软件问东问西，点允许运行即可）。

本软件 console(CMD) 版本诞生于 2016-1-18，GUI 版本发布于 2018-1-19。

**工作原理**

在修改资源文件前，给所有资源文件生成快照，修改文件后，运行本软件，检测被修改过的文件(到模板文件目录中查找其路径)，匹配并替换版本号为当前时间。

更新版本号后，会自动或可手动重新生成快照，如此循环。

## 如何使用源码

### 文件目录说明：

 - help.chm ------------------------- 软件的帮助文件（教程），这里用 jQuery 手册代替
 - icon.ico ------------------------- 软件的图标
 - app.py --------------------------- 软件 GUI 主程序
 - versionAction.py ----------------- 软件实现替换等各种功能的程序
 - lib.py --------------------------- 软件函数库
 - setup.py ------------------------- 打包程序：py2exe 打包 python 程序为 exe 可执行文件
 - ABC项目前端资源版本号修改器.zip -- 已经打包好的程序，解压开后执行 app.exe 即可，或者在 python 环境下运行上面的 app.py ，一样的效果。
 - project-ABC ---------------------- 网站项目目录(包含一些 js/css/cshtml 及其他伪文件)

### 体验和测试

**方法1 python 环境：**

拉取项目文件后，到当前目录运行 GUI 主程序即可，运行后就会弹出软件窗口。如： `python app.py`

**方法2 没有安装 python 环境：**

解压开 `ABC项目前端资源版本号修改器.zip` 执行 `app.exe` 即可。(需要windows 64位系统)

请使用 `project-ABC/Maticsoft.Web` 目录作为软件设置项的 `web根目录`。

然后对照下面的软件操作说明使用即可。

http://www.copterfly.cn/server-side/python/feResourceVersionEditor.html

(完)
